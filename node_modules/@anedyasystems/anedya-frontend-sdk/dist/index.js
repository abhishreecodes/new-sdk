'use strict';var R=class{tokenId;token;baseUrl;constructor(e,s){if(!e||e.trim()==="")throw new Error("Token ID is required");if(!s||s.trim()==="")throw new Error("Token is required");this.tokenId=e,this.token=s,this.baseUrl="https://api.anedya.io/v1";}};var D=class{tokenId;tokenBytes;signatureVersionBytes;signatureVersion="v1";authorizationMode="ANEDYASIGV1";baseUrl;constructor(e){let{token:s,tokenId:a}=e;this.tokenId=a,this.signatureVersionBytes=new TextEncoder().encode(this.signatureVersion),this.tokenBytes=new TextEncoder().encode(s),this.baseUrl=e.baseUrl;}};var T=class{constructor(e,s,a,u=1e4,c="desc"){this.variable=e;this.from=s;this.to=a;this.limit=u;this.order=c;if(c!=="asc"&&c!=="desc")throw new Error("Invalid order value. It should be either 'asc' or 'desc'.");if(u<1)throw new Error("Invalid limit value. It should be at least 1.");if(s>a)throw new Error("Invalid time range. 'from' should be less than or equal to 'to'.")}},p=class{isSuccess;error;isDataAvailable;data;count;startTime;endTime;constructor(){this.isSuccess=false,this.error={errorMessage:"",reasonCode:""},this.isDataAvailable=false,this.data=null,this.count=0,this.startTime=0,this.endTime=0;}},g=class{isSuccess;error;isDataAvailable;data;constructor(){this.isSuccess=false,this.error={errorMessage:"",reasonCode:""},this.isDataAvailable=false,this.data=null;}},N=class{constructor(e,s,a,u){this.namespace=e;this.key=s;this.value=a;this.type=u;if(this.namespace.scope!=="global"&&this.namespace.scope!=="node")throw new Error("Invalid namespace scope. It should be either 'global' or 'node'.");if(this.type!=="string"&&this.type!=="binary"&&this.type!=="float"&&this.type!=="boolean")throw new Error("Invalid type value. It should be either 'string', 'binary', 'float', or 'boolean'.")}},h=class{isSuccess;error;constructor(){this.isSuccess=false,this.error={errorMessage:"",reasonCode:""};}},C=class{constructor(e,s){this.namespace=e;this.key=s;if(this.namespace.scope!=="global"&&this.namespace.scope!=="node")throw new Error("Invalid namespace scope. It should be either 'global' or 'node'.")}},b=class{isSuccess;error;namespace;key;value;type;size;modified;created;constructor(){this.isSuccess=false,this.error={errorMessage:"",reasonCode:""},this.namespace={scope:"",id:""},this.key="",this.value=void 0,this.type="",this.size=0,this.modified=0,this.created=0;}},K=class{constructor(e,s){this.namespace=e;this.key=s;if(this.namespace.scope!=="global"&&this.namespace.scope!=="node")throw new Error("Invalid namespace scope. It should be either 'global' or 'node'.")}},A=class{isSuccess;error;constructor(){this.isSuccess=false,this.error={errorMessage:"",reasonCode:""};}},x=class{constructor(e,s,a,u,c){this.filter=e;this.orderby=s;this.order=a;this.limit=u;this.offset=c;if(this.filter.namespace.scope!=="global"&&this.filter.namespace.scope!=="node")throw new Error("Invalid namespace scope. It should be either 'global' or 'node'.")}},I=class{isSuccess;error;count;totalCount;data;next;constructor(){this.isSuccess=false,this.error={errorMessage:"",reasonCode:""},this.count=0,this.totalCount=0,this.data=void 0,this.next=0;}},S=class{isSuccess;error;data;constructor(){this.isSuccess=false,this.error={errorMessage:"",reasonCode:""},this.data=void 0;}},v=class{constructor(e,s){this.time=e;this.variable=s;if(!Number.isFinite(e)||e<=0)throw new Error("Invalid time: must be a positive number (UNIX timestamp).");let a=Math.floor(Date.now()/1e3);if(e>a)throw new Error("Invalid time: timestamp cannot be in the future.");if(!s||typeof s!="string")throw new Error("Invalid variable: must be a non-empty string.")}},f=class{isSuccess;error;count;data;constructor(){this.error={errorMessage:"",reasonCode:""},this.isSuccess=false,this.count=0,this.data=[];}};var m=async(o,e,s)=>{try{let u=new TextEncoder().encode(JSON.stringify(o)),c=await crypto.subtle.digest("SHA-256",u),l=new Uint8Array(c),y=new Uint8Array(8);new DataView(y.buffer).setBigUint64(0,BigInt(s),!1);let d=new Uint8Array(l.length+y.length+e.signatureVersionBytes.length+e.tokenBytes.length);d.set(l,0),d.set(y,l.length),d.set(e.signatureVersionBytes,l.length+y.length),d.set(e.tokenBytes,l.length+y.length+e.signatureVersionBytes.length);let i=await crypto.subtle.digest("SHA-256",d);return Array.from(new Uint8Array(i)).map(t=>t.toString(16).padStart(2,"0")).join("")}catch(a){console.log(a);}};var G=async(o,e,s,a)=>{let u=`${o}/data/getData`,c={nodes:s,variable:a.variable,from:Math.floor(a.from/1e3),to:Math.floor(a.to/1e3),limit:a.limit,order:a.order},l=Math.floor(Date.now()/1e3),y=await m(c,e,l);try{let d={Authorization:e.authorizationMode,"x-Anedya-SignatureVersion":e.signatureVersion,"X-Anedya-Tokenid":e.tokenId,"X-Anedya-Timestamp":l.toString(),"X-Anedya-Signature":y,"Content-Type":"application/json"},i=await fetch(u,{method:"POST",credentials:"same-origin",headers:d,body:JSON.stringify(c)}),r=new p;try{let t=await i.json();if(r.isSuccess=t.success,r.error.errorMessage=t.error,r.error.reasonCode=t.reasonCode,r.isDataAvailable=!1,r.data=null,t.success){let n=t.data;n==null||n==null||Object.keys(n).length===0?r.isDataAvailable=!1:s.length===1?(n=n[s.toString()],r.data=n,r.isDataAvailable=!0):(r.data=n,r.isDataAvailable=!0);}return r.count=t.count,r.startTime=t.startTime,r.endTime=t.endTime,r}catch{return r.isSuccess=!1,r.error.reasonCode=i.status.toString(),r.error.errorMessage=i.statusText,r}}catch(d){throw console.error("Error during Get data request:",d),d}},k=async(o,e,s,a)=>{let u=`${o}/data/latest`,c={nodes:s,variable:a.variable},l=Math.floor(Date.now()/1e3),y=await m(c,e,l);try{let d={Authorization:e.authorizationMode,"x-Anedya-SignatureVersion":e.signatureVersion,"X-Anedya-Tokenid":e.tokenId,"X-Anedya-Timestamp":l.toString(),"X-Anedya-Signature":y,"Content-Type":"application/json"},i=await fetch(u,{method:"POST",credentials:"same-origin",headers:d,body:JSON.stringify(c)}),r=new g;try{let t=await i.json();if(r.isSuccess=t.success,r.error.errorMessage=t.error,r.error.reasonCode=t.reasonCode,r.isDataAvailable=!1,r.data=null,t.success){let n=t.data;n==null||n==null||Object.keys(n).length===0?r.isDataAvailable=!1:s.length===1?(n=n[s.toString()],r.data=n,r.isDataAvailable=!0):(r.data=n,r.isDataAvailable=!0);}return r}catch{return r.isSuccess=!1,r.error.reasonCode=i.status.toString(),r.error.errorMessage=i.statusText,r}}catch(d){throw console.error("Error during get latest data request:",d),d}};var V=async(o,e,s,a)=>{let u=`${o}/valuestore/setValue`,c;a.namespace.scope==="node"?c=s[0]:c=a.namespace.id;let l={namespace:{scope:a.namespace.scope,id:c},key:a.key,value:a.value,type:a.type},y=Math.floor(Date.now()/1e3),d=await m(l,e,y);try{let i={Authorization:e.authorizationMode,"x-Anedya-SignatureVersion":e.signatureVersion,"X-Anedya-Tokenid":e.tokenId,"X-Anedya-Timestamp":y.toString(),"X-Anedya-Signature":d,"Content-Type":"application/json"},r=await fetch(u,{method:"POST",credentials:"same-origin",headers:i,body:JSON.stringify(l)}),t=new h;try{let n=await r.json();return t.isSuccess=n.success,t.error.errorMessage=n.error,t.error.reasonCode=n.reasonCode,t}catch{return t.isSuccess=!1,t.error.errorMessage=r.statusText,t.error.reasonCode=r.status.toString(),t}}catch(i){throw console.error("Error during set key: ",i),i}},O=async(o,e,s,a)=>{let u=`${o}/valuestore/getValue`,c;a.namespace.scope==="node"?c=s[0]:c=a.namespace.id;let l={namespace:{scope:a.namespace.scope,id:c},key:a.key},y=Math.floor(Date.now()/1e3),d=await m(l,e,y);try{let i={Authorization:e.authorizationMode,"x-Anedya-SignatureVersion":e.signatureVersion,"X-Anedya-Tokenid":e.tokenId,"X-Anedya-Timestamp":y.toString(),"X-Anedya-Signature":d,"Content-Type":"application/json"},r=await fetch(u,{method:"POST",credentials:"same-origin",headers:i,body:JSON.stringify(l)}),t=new b;try{let n=await r.json();return t.isSuccess=n.success,t.error.errorMessage=n.error,t.error.reasonCode=n.reasonCode,t.namespace=n.namespace,t.key=n.key,t.value=n.value,t.type=n.type,t.size=n.size,t.modified=n.modified,t.created=n.created,t}catch{return t.isSuccess=!1,t.error.errorMessage=r.statusText,t.error.reasonCode=r.status.toString(),t}}catch(i){throw console.error("Error during get key request: ",i),i}},q=async(o,e,s,a)=>{let u=`${o}/valuestore/delete`,c;a.namespace.scope==="node"?c=s[0]:c=a.namespace.id;let l={namespace:{scope:a.namespace.scope,id:c},key:a.key},y=Math.floor(Date.now()/1e3),d=await m(l,e,y);try{let i={Authorization:e.authorizationMode,"x-Anedya-SignatureVersion":e.signatureVersion,"X-Anedya-Tokenid":e.tokenId,"X-Anedya-Timestamp":y.toString(),"X-Anedya-Signature":d,"Content-Type":"application/json"},r=await fetch(u,{method:"POST",credentials:"same-origin",headers:i,body:JSON.stringify(l)}),t=new A;try{let n=await r.json();return t.isSuccess=n.success,t.error.errorMessage=n.error,t.error.reasonCode=n.reasonCode,t}catch{return t.isSuccess=!1,t.error.errorMessage=r.statusText,t.error.reasonCode=r.status.toString(),t}}catch(i){throw console.error("Error during fetch operation:",i),i}},M=async(o,e,s,a)=>{let u=`${o}/valuestore/scan`,c;a.filter.namespace.scope==="node"?c=s[0]:c=a.filter.namespace.id;let l={filter:{namespace:{scope:a.filter.namespace.scope,id:c}},orderby:a.orderby,order:a.order,limit:a.limit,offset:a.offset},y=Math.floor(Date.now()/1e3),d=await m(l,e,y);try{let i={Authorization:e.authorizationMode,"x-Anedya-SignatureVersion":e.signatureVersion,"X-Anedya-Tokenid":e.tokenId,"X-Anedya-Timestamp":y.toString(),"X-Anedya-Signature":d,"Content-Type":"application/json"},r=await fetch(u,{method:"POST",credentials:"same-origin",headers:i,body:JSON.stringify(l)}),t=new I;try{let n=await r.json();return t.isSuccess=n.success,t.error.errorMessage=n.error,t.error.reasonCode=n.reasonCode,t.count=n.count,t.totalCount=n.totalCount,t.data=n.data,t.next=n.next,t}catch{return t.isSuccess=!1,t.error.errorMessage=r.statusText,t.error.reasonCode=r.status.toString(),t}}catch(i){throw console.error("Error during scan vs operation: ",i),i}};var U=async(o,e,s,a)=>{let u=`${o}/health/status`,c={nodes:s,lastContactThreshold:a},l=Math.floor(Date.now()/1e3),y=await m(c,e,l);try{let d={Authorization:e.authorizationMode,"x-Anedya-SignatureVersion":e.signatureVersion,"X-Anedya-Tokenid":e.tokenId,"X-Anedya-Timestamp":l.toString(),"X-Anedya-Signature":y,"Content-Type":"application/json"},i=await fetch(u,{method:"POST",credentials:"same-origin",headers:d,body:JSON.stringify(c)}),r=new S;try{let t=await i.json();return r.isSuccess=t.success,r.error.errorMessage=t.error,r.error.reasonCode=t.reasonCode,r.isSuccess&&(s.length===1?r.data=t.data[s[0]]:r.data=t.data),r}catch{return r.isSuccess=!1,r.error.errorMessage=i.statusText,r.error.reasonCode=i.status.toString(),r}}catch(d){throw console.error("Error during fetch operation:",d),d}};var P=async(o,e,s,a)=>{let u=`${o}/data/snapshot`,c={nodes:s,time:a?.time,variable:a?.variable},l=Math.floor(Date.now()/1e3),y=await m(c,e,l);try{let d={Authorization:e.authorizationMode,"x-Anedya-SignatureVersion":e.signatureVersion,"X-Anedya-Tokenid":e.tokenId,"X-Anedya-Timestamp":l.toString(),"X-Anedya-Signature":y,"Content-Type":"application/json"},i=await fetch(u,{method:"POST",credentials:"same-origin",headers:d,body:JSON.stringify(c)}),r=new f;try{let t=await i.json();return r.isSuccess=t.success,r.error.errorMessage=t.error,r.error.reasonCode=t.reasonCode,r.isSuccess&&(s.length===1?r.data=t.data.filter(n=>n.node===s[0]):r.data=t.data,r.count=t.count),r}catch{return r.isSuccess=!1,r.error.errorMessage=i.statusText,r.error.reasonCode=i.status.toString(),r}}catch(d){throw console.error("Error during fetch operation:",d),d}};var w=class{#e;#t;#r;constructor(e,s){let{baseUrl:a,tokenId:u,tokenBytes:c,signatureVersionBytes:l,signatureVersion:y,authorizationMode:d}=e;this.#e=s,this.#t=a,this.#r={tokenId:u,tokenBytes:c,signatureVersion:y,signatureVersionBytes:l,authorizationMode:d};}getNodeId(){return this.#e}async getData(e){return await G(this.#t,this.#r,[this.#e],e)}async getLatestData(e){let s={variable:e};return await k(this.#t,this.#r,[this.#e],s)}async setKey(e){return await V(this.#t,this.#r,[this.#e],e)}async getKey(e){return await O(this.#t,this.#r,[this.#e],e)}async deleteKey(e){return await q(this.#t,this.#r,[this.#e],e)}async scanKeys(e){return await M(this.#t,this.#r,[this.#e],e)}async getDeviceStatus(e){return await U(this.#t,this.#r,[this.#e],e)}async getSnapshot(e){return await P(this.#t,this.#r,[this.#e],e)}};var E=class{NewConfig(e,s){return new R(e,s)}NewClient(e){return new D(e)}NewNode(e,s){return new w(e,s)}};var B=(s=>(s.GLOBAL="global",s.NODE="node",s))(B||{}),X=(u=>(u.STRING="string",u.BINARY="binary",u.FLOAT="float",u.BOOLEAN="boolean",u))(X||{});var _={Success:-1,Unknown:0,Failure:1,HttpRequestError:3,HttpRequestTimeout:4,keyNotFound:5};function z(o){return Object.fromEntries(Object.entries(_).map(([s,a])=>[a,s]))[o]||"UnknownErrorCode"}
exports.Anedya=E;exports.AnedyaDataType=X;exports.AnedyaDeleteKeyReq=K;exports.AnedyaDeleteKeyResp=A;exports.AnedyaError=_;exports.AnedyaGetDataReq=T;exports.AnedyaGetDataResp=p;exports.AnedyaGetDeviceStatusResp=S;exports.AnedyaGetKeyReq=C;exports.AnedyaGetKeyResp=b;exports.AnedyaGetLatestDataResp=g;exports.AnedyaGetSnapshotReq=v;exports.AnedyaGetSnapshotResp=f;exports.AnedyaScanKeysReq=x;exports.AnedyaScanKeysResp=I;exports.AnedyaScope=B;exports.AnedyaSetKeyReq=N;exports.AnedyaSetKeyResp=h;exports.getAnedyaErrorMessage=z;//# sourceMappingURL=index.js.map
//# sourceMappingURL=index.js.map